SSG for SpoilerAL ver 6.2

[script]
[title]*** パラサイトルーチンのテスト ***
[creator]変態紳士
[maker]有)洗濯機の中にはビスケットがひとつ
[process]SpoilerAL.exe
[note]wordwrap
よくわからないテスト
[/note]

[involve]ssl

[group]main

	[allocate]0, 1024, ER
	[subject]パラサイトルーチンの作成/ON\/OFF/_:b_toggle, 0x00, ssl->parasite, offset
	[subject][10進\/16進]ボタンをクリック/現在値/_:calc, _Memory::0, 0, 0xFFFFFFFF, unsigned

[/group]

// --- 書き換え前 ---
//	push    ebp                         ; 00447194 _ 55
//	mov     ebp, esp                    ; 00447195 _ 8B. EC
//	mov     eax, dword ptr [ebp + 8H]   ; 00447197 _ 8B. 45, 08
//
// --- 書き換え後 ---
//	jmp     parasite                    ; 00447194 _ E9, <offset parasite - 00447199H>
//	nop                                 ; 00447199 _ 90
//
//parasite:
//	push    MB_TOPMOST                  ; parasite + 00000000 _ 68, 00040000
//	push    offset caption              ; parasite + 00000005 _ 68, <offset parasite + 30H>
//	push    offset text                 ; parasite + 0000000A _ 68, <offset parasite + 40H>
//	push    0                           ; parasite + 0000000F _ 6A, 00
//	call    MessageBoxA                 ; parasite + 00000011 _ E8, <MessageBoxA - (offset parasite + 16H)>
//
//	push    ebp                         ; parasite + 00000016 _ 55
//	mov     ebp, esp                    ; parasite + 00000017 _ 8B. EC
//	mov     eax, dword ptr [ebp + 8H]   ; parasite + 00000019 _ 8B. 45, 08
//	jmp     0044719AH                   ; parasite + 0000001C _ E9, <0044719AH - (offset parasite + 1EH)>
//
//caption:
//	byte    '情報', 0
//text:
//	byte    '[10進/16進]ボタンがクリックされました', 0

[group]parasite
0x447194, E9 $4 Memory::0 - 0x447199 $$, 55 8B EC 8B 45
0x447199, 90                           , 08

_Memory::0       , 68 $4 0x00040000 $$
_Memory::0 + 0x05, 68 $4 Memory::0 + 0x30 $$
_Memory::0 + 0x0A, 68 $4 Memory::0 + 0x40 $$
_Memory::0 + 0x0F, 6A 00
_Memory::0 + 0x11, E8 $4 MName::user32.dll::MessageBoxA - (Memory::0 + 0x16) $$

_Memory::0 + 0x16, 55
_Memory::0 + 0x17, 8B EC
_Memory::0 + 0x19, 8B 45 08
_Memory::0 + 0x1C, E9 $4 0x44719A - (Memory::0 + 0x21) $$

_Memory::0 + 0x30, 8FEE95F100
_Memory::0 + 0x40, 5B313090692F313690695D837B835E839382AA834E838A8362834E82B382EA82DC82B582BD00
[/group]

// 短くするとこうなる (アドレスの間違いが減る代りに読みにくい)
// 0x447194, E9 $4 Memory::0 - 0x447199 $$ 90, 558BEC8B4508
// _Memory::0, 680000040068 $4 Memory::0 + 0x30 $$ 68 $4 Memory::0 + 0x40 $$ 6A00E8 $4 MName::user32.dll::MessageBoxA - Memory::0 - 0x16 $$ 558BEC8B4508E9 $4 0x447179 - Memory::0 $$
// _Memory::0 + 0x30, 8FEE95F100
// _Memory::0 + 0x40, 5B313090692F313690695D837B835E839382AA834E838A8362834E82B382EA82DC82B582BD00

[/involve]

[replace]0, ssl->main

[/script]
